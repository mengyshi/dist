"use strict";$(function(){var t,n,e;function o(t){var n=t.val(),e="";if(""==$.trim(n))e="邮箱或手机号码不能为空";else if(0<=n.indexOf("@")){/^([a-zA-Z0-9]+[-|_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/.test(n)||(e="您输入的邮箱地址格式不正确")}else if(isNaN(n))e="您输入的手机号或邮箱不正确";else{/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1})|(17[0-9]{1})|(14[0-9]{1}))+\d{8})$/.test(n)||(e="您输入的手机号码格式不正确")}return""!=e?(t.parent().prev().css("color","#e5004b").text(e),!1):(t.parent().prev().text(""),!0)}function a(t){var n=t.val();return/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,16}$/.test(n)?(t.parent().prev().prev().html(""),!0):(t.parent().prev().prev().css("color","#e5004b").html("请输入6-16位字符,必须包含英文字母和数字"),!1)}function r(){return[Math.floor(10*Math.random()),Math.floor(10*Math.random()),Math.floor(10*Math.random()),Math.floor(10*Math.random())]}function s(t){return Number(t.val())==Number(t.parent().next().html())}$(".rms p:nth-of-type(4)").next().css({background:(t=Math.floor(256*Math.random()),n=Math.floor(256*Math.random()),e=Math.floor(256*Math.random()),"rgb("+t+","+n+","+e+")"),color:"#fff","letter-spacing":"10px","font-size":"18px","line-height":"40px","margin-left":"5px"}).html(r().join("")),$(".login-header a").click(function(){$(".login").css({display:"none",left:"450px"}).next().css({display:"block"}).animate({left:"888px"}).parent().prev().find("span").text("欢迎注册")}),$(".register-header a").click(function(){$(".register").css({display:"none",left:"450px"}).prev().css({display:"block"}).animate({left:"888px"}).parent().prev().find("span").text("欢迎登录")}),$(".rms p:nth-of-type(2)").find("input").change(function(){o($(this))||console.log($(this).parent().prev())}),$(".rms p:nth-of-type(3)").find("input").change(function(){a($(this))||console.log($(this).parent().prev().prev())}),$(".rms p:nth-of-type(4)").find("input").change(function(){s($(this))&&console.log("true")}),$(".register-btn").click(function(){var n=$(this).siblings().find("p:nth-of-type(2)").find("input"),e=$(this).siblings().find("p:nth-of-type(3)").find("input"),t=$(this).siblings().find("p:nth-of-type(4)").find("input"),i=r().join("")+r().join("")+"@163.com";a(e)&&o(n)&&s(t)&&(console.log(i),$.get("http://47.104.244.134:8080/username.do",{username:n.val()},function(t){console.log(t),0==t.code?alert("该用户名已存在，请直接登录或换一个用户名注册"):(alert("注册成功，请登录"),$.post("http://47.104.244.134:8080/usersave.do",{username:n.val(),password:e.val(),email:i,sex:1},function(t){console.log(t),alert("注册成功")}))}))});var i=!0;$(".slide").children().mousedown(function(){console.log($(this));var t=$(this).parent().siblings().find("p:nth-of-type(2)").find("input"),n=$(this).parent().siblings().find("p:nth-of-type(3)").find("input");o(t)&&a(n)?$(this).animate({left:"240px"}).parent().css({background:"green","text-align":"center",color:"#fff"}).text("验证通过"):i=!1}),$(".log-btn").click(function(){var n=$(this).siblings().find("p:nth-of-type(2)").find("input"),t=$(this).siblings().find("p:nth-of-type(3)").find("input");i?$.post("http://47.104.244.134:8080/userlogin.do",{name:n.val(),password:t.val()},function(t){0==t.code?(localStorage.setItem("loginmessage",JSON.stringify({token:t.data.token,username:n.val()})),location.href="index.html"):alert("用户名或密码错误，请重新输入")}):location.reload()})});